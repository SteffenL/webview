include(CTest)
if(BUILD_TESTING)
    set(TIMEOUT_SECONDS 5)
    file(GLOB_RECURSE TEST_SOURCES CONFIGURE_DEPENDS *_test.c *_test.cc)
    foreach(TEST_SOURCE ${TEST_SOURCES})
        cmake_path(GET TEST_SOURCE STEM TARGET_NAME)
        string(REGEX REPLACE _test$ "" TEST_NAME ${TARGET_NAME})
        add_executable(${TARGET_NAME} ${TEST_SOURCE})
        target_link_libraries(${TARGET_NAME} PRIVATE webview_warnings webview_s)
        add_test(NAME ${TEST_NAME} COMMAND ${TARGET_NAME})
        set_tests_properties(${TEST_NAME} PROPERTIES TIMEOUT ${TIMEOUT_SECONDS})
    endforeach()
endif()
