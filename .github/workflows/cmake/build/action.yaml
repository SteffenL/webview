name: CMake Build
description: CMake action for building project.
inputs:
  build-dir:
    description: CMake build directory
    required: true
    default: build
  build-type:
    description: Semicolon-separated CMake build types (Debug, Release, etc)
    required: true
    default: Release
  shell:
    description: Shell
    required: true
    default: bash
  target:
    description: CMake target to build
    required: false
runs:
  using: composite
  steps:
    - name: Build
      run: |
        # Build
        cmake_args=()
        if [[ ! -z "${{ inputs.target }}" ]]; then
          cmake_args+=(--target "${{ inputs.target }}")
        fi
        build_types="${{ inputs.build-type }}"
        build_types=(${build_types//;/ })
        for build_type in "${build_types[@]}"; do
          cmake --build "${{ inputs.build-dir }}" --config "${build_type}" "${cmake_args[@]}"
        done
      shell: ${{ inputs.shell }}
